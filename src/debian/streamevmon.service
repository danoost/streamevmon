[Unit]
Description=Streamevmon time series anomaly detection pipeline
Documentation=https://github.com/wanduow/streamevmon
After=network.target rabbitmq-server.service taskmanager@streamevmon.service
Wants=rabbitmq-server.service
Requires=taskmanager@streamevmon.service

[Install]
WantedBy=multi-user.target

[Service]
User=flink
Group=flink

Type=simple
ExecStart=/usr/share/flink/bin/standalone-job.sh start-foreground --job-classname nz.net.wand.streamevmon.runners.examples.MetricGatherer
ExecStop=/usr/share/flink/bin/standalone-job.sh stop
ExecStopPost=/usr/share/flink/bin/taskmanager.sh stop
SuccessExitStatus=143

Restart=on-failure

WorkingDirectory=/usr/share/flink
